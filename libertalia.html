<!DOCTYPE html>
<!-- SPDX-License-Identifier: 0BSD -->
<html lang="en">
<head>
<meta charset=UTF-8>
<title>Libertalia: Winds of Galecrest</title>
</head>
<body>
Libertalia: Winds of Galecrest<br>
Deck Randomizer<br><br>
<button onclick="generate()">Shuffle Deck</button>
<br>
<button onclick="show('day1')">Show Day 1</button>
<div id="day1" style="display: none;">
</div><br>
<button onclick="show('day2')">Show Day 2</button>
<div id="day2" style="display: none;">
</div><br>
<button onclick="show('day3')">Show Day 3</button>
<div id="day3" style="display: none;">
</div><br>
</body>
<script>
var deck;

// Shuffles an array of numbers
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

// Unhide a div block
function show(div) {
    document.getElementById(div).style.display = 'block';
}

// Updates the numbers in each day
function update() {
  document.getElementById("day1").innerHTML = deck.slice(0, 6).sort();
  document.getElementById("day2").innerHTML = deck.slice(6, 12).sort();
  document.getElementById("day3").innerHTML = deck.slice(12, 18).sort();
}

// Generate a new shuffled list, updates the web page, and saves the list in a cookie
function generate() {
  deck = Uint8Array.from({length: 40}, (v, k) => k+1);
  shuffle(deck);
  update();
  document.cookie = deck.toString() + "; max-age=" + (60 * 60 * 24 * 7) + ";";
}

function check(num) {
  return Number.isInteger(num) && (num >= 1) && (num <= 40);
}

deck = Uint8Array.from(document.cookie.split(',').map(Number));
if ((deck.length == 40) && deck.every(check)) {
  // If the cookie contains a valid shuffled list, just use it
  update();
} else {
  // Otherwise, generate a new one
  generate();
}
</script>
